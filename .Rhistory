update()
install.packages(c("boot", "foreign", "Matrix", "mgcv"))
df <- read.xlsx2("2017EESStats.xlsx",
sheetIndex = 2)
df <- read.xlsx2("<name and extension of your file>",
sheetIndex = 1,
startRow=2,
colIndex = 2)
#
library(ggplot2)
library(readxl)
setwd("C:/Users/bjr21/Documents/GitHub/DunnEES")
df <- read_xlsx("2017EESStats.xlsx")
df <- read_excel("2017EESStats.xlsx", sheet=2)
df <- read_excel("2017EESStatsClean.xlsx", sheet=2)
warnings()
df <- read_excel("2017EESStatsClean.xlsx", sheet=2, stringsAsFactors=TRUE)
df
View(df)
df$race.f <- factor(df$Race)
is.factor(df$race.f)
df$sex.f <- factor(df$Sex)
is.factor(df$sex.f)
df$tenure.f <- factor(df$Tenure)
is.factor(df$tenure.f)
df$union.f <- factor(df$Union)
is.factor(df$union.f)
df$Agency.f <- factor(df$Agency)
is.factor(df$Agency.f)
summary(lm(StateComp ~ race.f, data = df))
summary(lm(StateComp ~ race.f + sex.f + tenure.f + union.f + Agency.f, data = df))
View(df)
View(df)
relevel(df$race.f, "White")
summary(lm(StateComp ~ tenure.f + union.f + race.f + sex.f + Agency.f, data = df))
df$race.f <- factor(df$Race)
is.factor(df$race.f)
df <- within(df, df$race.f <- relevel(df$race.f, ref = "White"))
summary(lm(StateComp ~ tenure.f + union.f + race.f + sex.f + Agency.f, data = df))
df$sex.f <- factor(df$Sex)
is.factor(df$sex.f)
df <- within(df, df$sex.f <- relevel(df$sex.f, ref = "Male"))
summary(lm(StateComp ~ tenure.f + union.f + race.f + sex.f + Agency.f, data = df))
df <- within(df, df$sex.f <- relevel(df$sex.f, ref = 1))
summary(lm(StateComp ~ tenure.f + union.f + race.f + sex.f + Agency.f, data = df))
df <- within(df, df$sex.f <- relevel(df$sex.f, ref = 2))
summary(lm(StateComp ~ tenure.f + union.f + race.f + sex.f + Agency.f, data = df))
df <- within(df, df$sex.f <- relevel(df$sex.f, ref = Male))
df <- within(df, df$sex.f <- relevel(df$sex.f, ref = "Male))
df <- within(df, df$sex.f <- relevel(df$sex.f, ref = "Male"))
df <- within(df, df$sex.f <- relevel(df$sex.f, ref = "Male"))
summary(lm(StateComp ~ tenure.f + union.f + race.f + sex.f + Agency.f, data = df))
df <- within(df, df$sex.f <- relevel(df$sex.f, "Male"))
summary(lm(StateComp ~ tenure.f + union.f + race.f + sex.f + Agency.f, data = df))
df <- within(df, df$sex.f <- relevel(df$sex.f, "Female"))
summary(lm(StateComp ~ tenure.f + union.f + race.f + sex.f + Agency.f, data = df))
df$sex.f <- factor(df$Sex, levels = {"Male", "Female"})
df$sex.f <- factor(df$Sex, levels = c("Male","Female"))
is.factor(df$sex.f)
df <- within(df, df$sex.f <- relevel(df$sex.f, "Female"))
summary(lm(StateComp ~ tenure.f + union.f + race.f + sex.f + Agency.f, data = df))
clear
clc
#
library(ggplot2)
library(readxl)
setwd("C:/Users/bjr21/Documents/GitHub/DunnEES")
df <- read_excel("2017EESStatsClean.xlsx", sheet=2)
df$Race.f <- factor(df$Race)
is.factor(df$Race.f)
df <- within(df, df$Race.f <- relevel(df$Race.f, ref = "White"))
summary(lm(StateComp ~ tenure.f + union.f + race.f + sex.f + Agency.f, data = df))
setwd("C:/Users/bjr21/Documents/GitHub/DunnEES")
df <- read_excel("2017EESStatsClean.xlsx", sheet=2)
df$Race.f <- factor(df$Race)
is.factor(df$Race.f)
df <- within(df, df$Race.f <- relevel(df$Race.f, ref = "White"))
df$Sex.f <- factor(df$Sex, levels = c("Male","Female"))
is.factor(df$Sex.f)
df$Tenure.f <- factor(df$Tenure, levels)
is.factor(df$Tenure.f)
df$Union.f <- factor(df$Union)
is.factor(df$Union.f)
df$Agency.f <- factor(df$Agency)
is.factor(df$Agency.f)
summary(lm(StateComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
#
library(ggplot2)
library(readxl)
setwd("C:/Users/bjr21/Documents/GitHub/DunnEES")
df <- read_excel("2017EESStatsClean.xlsx", sheet=2)
df$Race.f <- factor(df$Race)
is.factor(df$Race.f)
df$Sex.f <- factor(df$Sex, levels = c("Male","Female"))
is.factor(df$Sex.f)
df$Tenure.f <- factor(df$Tenure, levels)
df$Tenure.f <- factor(df$Tenure)
is.factor(df$Tenure.f)
df$Union.f <- factor(df$Union)
is.factor(df$Union.f)
df$Agency.f <- factor(df$Agency)
is.factor(df$Agency.f)
summary(lm(StateComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(df)
summary(df$Race.f)
df$Race.f <- factor(df$Race, levels = C("White","American Indian or Alaska Native","Asian Indian","Black/African American","Chinese","Filipino","Guamanian or Chamorro","Hispanic, Latino, or of Spanish Origin","Japanese","Korean","Native Hawaiian","Other (please specify)","Other Pacific Islander","Samoan","Vietnamese",NA))
df$Race.f <- factor(df$Race, levels = c("White","American Indian or Alaska Native","Asian Indian","Black/African American","Chinese","Filipino","Guamanian or Chamorro","Hispanic, Latino, or of Spanish Origin","Japanese","Korean","Native Hawaiian","Other (please specify)","Other Pacific Islander","Samoan","Vietnamese",NA))
summary(lm(StateComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(df$Union.f)
df$Union.f <- factor(df$Union, levels = c("Union member","Fair share employee","Non-union supervisor","None of the above",NA))
is.factor(df$Union.f)
summary(lm(StateComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(df$Tenure.f)
df$Tenure.f <- factor(df$Tenure, levels=c("0-2 years","2-5 years","5-15 years","15+ years",NA))
is.factor(df$Tenure.f)
summary(lm(StateComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(lm(RetentionComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(lm(TalentComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(lm(TalentComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(lm(EnviroComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(lm(CustomerComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(lm(UnitComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(lm(SuperComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(lm(LeaderComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
summary(lm(StateComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
Retention <- summary(lm(RetentionComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
tidy_Retention <- tidy(Retention)
library(broom)
tidy_Retention <- tidy(Retention)
tidy_Retention
#Import packages
library(ggplot2)
library(readxl)
library(broom)
#set directory to GitHub repo
setwd("C:/Users/bjr21/Documents/GitHub/DunnEES")
#Import file
df <- read_excel("2017EESStatsClean.xlsx", sheet=2)
#Create factor variables from string variables
df$Race.f <- factor(df$Race, levels = c("White","American Indian or Alaska Native","Asian Indian","Black/African American","Chinese","Filipino","Guamanian or Chamorro","Hispanic, Latino, or of Spanish Origin","Japanese","Korean","Native Hawaiian","Other (please specify)","Other Pacific Islander","Samoan","Vietnamese",NA))
is.factor(df$Race.f)
df$Sex.f <- factor(df$Sex, levels = c("Male","Female"))
is.factor(df$Sex.f)
df$Tenure.f <- factor(df$Tenure, levels=c("0-2 years","2-5 years","5-15 years","15+ years",NA))
is.factor(df$Tenure.f)
df$Union.f <- factor(df$Union, levels = c("Union member","Fair share employee","Non-union supervisor","None of the above",NA))
is.factor(df$Union.f)
df$Agency.f <- factor(df$Agency)
is.factor(df$Agency.f)
#Run Regressions and save outputs into CSV
Retention <- summary(lm(RetentionComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
tidy_Retention <- tidy(Retention)
write.csv(tidy_Retention, "tidy_Retention.csv")
Talent <- summary(lm(TalentComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
tidy_Talent <- tidy(Talent)
write.csv(tidy_Talent, "tidy_Talent.csv")
Enviro <- summary(lm(EnviroComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
tidy_Enviro <- tidy(Enviro)
write.csv(tidy_Enviro, "tidy_Enviro.csv")
Eval <- summary(lm(EvalComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
tidy_Eval <- tidy(Eval)
write.csv(tidy_Eval, "tidy_Eval.csv")
Customer <- summary(lm(CustomerComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
tidy_Customer <- tidy(Customer)
Unit <- summary(lm(UnitComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
write.csv(tidy_Customer, "tidy_Customer.csv")
write.csv(tidy_Unit, "tidy_Unit.csv")
tidy_Unit <- tidy(Unit)
Super <- summary(lm(SuperComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
tidy_Super <- tidy(Super)
write.csv(tidy_Super, "tidy_Super.csv")
Leader <- summary(lm(LeaderComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
tidy_Leader <- tidy(Leader)
write.csv(tidy_Leader, "tidy_Leader.csv")
State <- summary(lm(StateComp ~ Tenure.f + Union.f + Race.f + Sex.f + Agency.f, data = df))
tidy_State <- tidy(State)
write.csv(tidy_State, "tidy_State.csv")
tidy_Unit <- tidy(Unit)
write.csv(tidy_Unit, "tidy_Unit.csv")
