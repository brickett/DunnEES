update()
install.packages(c("boot", "foreign", "Matrix", "mgcv"))
#Import packages
library(readxl)
library(broom)
library(tibble)
library(xlsx)
library(rJava)
library(rJava)
library(xlsx)
#Import packages
library(readxl)
library(broom)
library(tibble)
library(xlsx)
#set directory to GitHub repo
setwd("C:/Users/bjr21/Documents/GitHub/DunnEES")
#Import file
df <- read_excel("2017EESStatsClean.xlsx", sheet=3)
#Make Agency a factor variable
df$Agency.f <- factor(df$Agency)
is.factor(df$Agency.f)
names <- c("Abraham Lincoln Presidential Library and Museum","Aging, Department on","Agriculture, Department of","Arts Council","Capital Development Board",
"Central Management Services, Department of","Children and Family Services, Department of","Civil Service Commission, Illinois",
"Commerce and Economic Opportunity, Department of","Commerce Commission, Illinois","Community College Board","Corrections, Department of",
"Criminal Justice Information Authority","Deaf and Hard of Hearing Commission, Illinois","Developmental Disabilities, Illinois Council on",
"Education, Illinois State Board of","Educational Labor Relations Board","Emergency Management Agency","Employment Security, Department of",
"Environmental Protection Agency","Financial and Professional Regulation, Department of","Gaming Board, Illinois","Guardianship and Advocacy Commission",
"Healthcare and Family Services - Formerly known as Public Aid, Dept. of","Higher Education, Board of","Human Rights Commission","Human Rights, Department of",
"Human Services, Department of","Innovation and Technology, Department of","Insurance Department of","Juvenile Justice, Department of","Labor Relations Board",
"Labor, Department of","Law Enforcement Training and Standards Board, Illinois","Liquor Control Commission","Lottery, Illinois",
"Management and Budget, Office of","Medical District Commission","Natural Resources, Department of","Other (please specify)",
"Pollution Control Board","Power Agency, Illinois","Prisoner Review Board, Illinois","Property Tax Appeal Board","Public Health, Department of",
"Racing Board, Illinois","Revenue, Department of","State Fire Marshal","State Police, Illinois","State Retirement Systems",
"Student Assistance Commission, Illinois","Toll Highway Authority, Illinois State","Transportation, Department of","Veterans Affairs, Department of",
"Volunteerism Community Service, Governor's Commission on","Workers' Compensation Commission, Illinois")
abbrevs <- c("ALPLM","AGE","AG","AC","CDB","CMS","DCFS","CSC","DCEO","ICC","ICCB","DOC","ICJIA","DHHC","CDD","ISBE","ELRB","IEMA","IDES","IEPA","IDFPR","GAM","GAC",
"HFS","IBHE","HRC","DHS","DHR","DoIT","DOI","DJJ","ILRB","DOL","LETSB","LCC","LOT","GOMB","MDC","IDNR","Other","PCB","IPA","PRB","PTAB","DPH","IRB","REV","OSFM","ISP","SRS",
"ISAC","TOL","DOT","VA","CVCS","WCC")
Xagency <- tibble(names, abbrevs)
questions <- (c(colnames(df)[3:9]))
filename = "test"
filext = ".xlsx"
sheet = colnames(df)[3:9]
write.xlsx(3, file=paste(filename,filext, sep = "" ),
sheetName=sheet[1], append=FALSE)
write.xlsx(df, file=paste(filename,filext, sep = "" ),
sheetName=sheet[1], append=FALSE)
filename = "test"
filext = ".xlsx"
sheet = colnames(df)[3:9]
write.xlsx(df, file=paste(filename,filext, sep = "" ),
sheetName=sheet[1], append=FALSE)
df[1:15,:]
df[1:15,1:2]
write.xlsx(df[1:15,1:2], file=paste(filename,filext, sep = "" ),
sheetName=sheet[1], append=TRUE)
write.xlsx(df[1:15,1:2], file=paste(filename,filext, sep = "" ),
sheetName=sheet[2], append=TRUE)
filename = "test"
filext = ".xlsx"
sheet = colnames(df)[3:9]
for (k in 1:length(sheet)){
write.xlsx(df[1:15,1:2], file=paste(filename,filext, sep = "" ),
sheetName=sheet[k], append=TRUE)
}
for (i in 1:nrow(df)){
while (df[i,1]!=Xagency[j,1]) {
j <- j+1
print(i)
}
}
j <- 1
for (i in 1:nrow(df)){
while (df[i,1]!=Xagency[j,1]) {
j <- j+1
print(i)
}
}
df[1:15,]
df[,2]
last=i
j <- 1
last <- 1
for (i in 1:nrow(df)){
while (df[i,1]!=Xagency[j,1]) {
j <- j+1
print(i)
comms = df[last:i-1,3:9]
last=i
}
}
comms
comms <- comms[!is.na(comms)]
comms2 <- comms[!is.na(comms),1]
comms2
View(comms2)
View(comms2)
comms[,1]
View(comms)
View(comms)
comms2 <- comms[!is.na(comms),1]
comms2 <- comms[,1]
View(comms2)
View(comms2)
comms2 <- comms2[!is.na(comms)]
comms2 <- comms2[!is.na(comms2)]
na.omit(comms)
test = na.omit(comms)
View(test)
View(test)
test = na.omit(comms[,1])
test = na.omit(comms[,2])
test = na.omit(comms[,3])
test = na.omit(comms[,4])
test = na.omit(comms[,5])
write.xlsx(na.omit(comms[,k]), file=paste(filename,filext, sep = "" ),
sheetName=sheet[k], append=TRUE)
filename = "test"
filext = ".xlsx"
sheet = colnames(df)[3:9]
for (i in 1:nrow(df)){
while (df[i,1]!=Xagency[j,1]) {
j <- j+1
print(i)
comms = df[last:i-1,3:9]
last=i
}
}
j <- 1
last <- 1
for (i in 1:nrow(df)){
while (df[i,1]!=Xagency[j,1]) {
j <- j+1
print(i)
comms = df[last:i-1,3:9]
last=i
}
}
filename = "test"
filext = ".xlsx"
sheet = colnames(df)[3:9]
for (k in 1:length(sheet)){
write.xlsx(na.omit(comms[,k]), file=paste(filename,filext, sep = "" ),
sheetName=sheet[k], append=TRUE)
}
for (k in 1:length(sheet)){
write.xlsx(na.omit(comms[,k]), file=paste(filename,filext, sep = "" ),
sheetName=sheet[k], append=TRUE, col.names = FALSE)
}
for (k in 1:length(sheet)){
write.xlsx(na.omit(comms[,k]), file=paste(filename,filext, sep = "" ),
sheetName=sheet[k], append=TRUE, col.names = FALSE)
}
write.xlsx(na.omit(comms[,k]), file=paste(filename,filext, sep = "" ),
sheetName=sheet[k], append=TRUE, col.names = FALSE, row.names = FALSE)
for (k in 1:length(sheet)){
write.xlsx(na.omit(comms[,k]), file=paste(filename,filext, sep = "" ),
sheetName=sheet[k], append=TRUE, col.names = FALSE, row.names = FALSE)
}
for (k in 1:length(sheet)){
write.xlsx(na.omit(comms[,k]), file=paste(filename,filext, sep = "" ),
sheetName=sheet[k], append=TRUE, col.names = FALSE, row.names = FALSE)
}
for (k in 1:length(sheet)){
write.xlsx(na.omit(comms[,k]), file=paste(filename,filext, sep = "" ),
sheetName=sheet[k], append=TRUE, col.names = FALSE)
}
